USE ozidar;
SET SESSION sql_mode = 'strict_all_tables';

DROP PROCEDURE IF EXISTS delete_event;
DROP PROCEDURE IF EXISTS edit_event;
DROP PROCEDURE IF EXISTS get_event;
DROP PROCEDURE IF EXISTS create_event;
DROP PROCEDURE IF EXISTS get_events;
DROP PROCEDURE IF EXISTS delete_member;
DROP PROCEDURE IF EXISTS edit_member;
DROP PROCEDURE IF EXISTS get_member;
DROP PROCEDURE IF EXISTS add_member;
DROP PROCEDURE IF EXISTS get_members;
DROP PROCEDURE IF EXISTS delete_calendar;
DROP PROCEDURE IF EXISTS edit_calendar;
DROP PROCEDURE IF EXISTS get_calendar;
DROP PROCEDURE IF EXISTS create_calendar;
DROP PROCEDURE IF EXISTS get_calendars;
DROP PROCEDURE IF EXISTS delete_user;
DROP PROCEDURE IF EXISTS change_pwd;
DROP PROCEDURE IF EXISTS create_user;

DROP TRIGGER IF EXISTS events_update;
DROP TRIGGER IF EXISTS events_insert;
DROP TRIGGER IF EXISTS members_delete;
DROP TRIGGER IF EXISTS members_update;
DROP TRIGGER IF EXISTS calendars_delete;
DROP TRIGGER IF EXISTS calendars_update;
DROP TRIGGER IF EXISTS calendars_insert;
DROP TRIGGER IF EXISTS users_delete;
DROP TRIGGER IF EXISTS users_update;
DROP TRIGGER IF EXISTS users_insert;

DROP FUNCTION IF EXISTS is_event_in_calendar;
DROP FUNCTION IF EXISTS n_admins;
DROP FUNCTION IF EXISTS is_an_admin;
DROP FUNCTION IF EXISTS is_a_member;
DROP FUNCTION IF EXISTS sole_admin_any_calendar;
DROP FUNCTION IF EXISTS sole_admin_specific_calendar;
DROP FUNCTION IF EXISTS user_exists;
DROP FUNCTION IF EXISTS authenticate_user;
DROP FUNCTION IF EXISTS token_to_username;
DROP FUNCTION IF EXISTS token_exists;
DROP FUNCTION IF EXISTS alert_regex;
DROP FUNCTION IF EXISTS repetition_regex;
DROP FUNCTION IF EXISTS is_valid_priority;
DROP FUNCTION IF EXISTS datetime_regex;
DROP FUNCTION IF EXISTS is_valid_role;
DROP FUNCTION IF EXISTS is_string;
DROP FUNCTION IF EXISTS is_hex_string;
DROP FUNCTION IF EXISTS pwd_regex;
DROP FUNCTION IF EXISTS username_regex;

DROP TABLE IF EXISTS events;
DROP TABLE IF EXISTS members;
DROP TABLE IF EXISTS calendars;
DROP TABLE IF EXISTS users;